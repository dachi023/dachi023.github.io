<!doctype html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><meta name="description" content="今日のやったこと"><title>Start “BONEN-KAI” days 🍻 | dachi.work</title><link rel="stylesheet" href="/style.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+JP&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Pacifico&display=swap"></head><body><header><h1><a href="/">dachi.work</a></h1></header><main><article><span>December 21, 2018</span><h1>Start “BONEN-KAI” days 🍻</h1><p><img src="https://cdn-images-1.medium.com/max/800/1*7lsVE_OQc-96xByV8fIXyg.png" alt="12月21日はバスケットボールの日、毎回突き指するんだよなぁ"> 12月21日は<a href="http://www.nnh.to/12/21.html">バスケットボールの日</a>、毎回突き指するんだよなぁ</p><h3>Firestoreのリアルタイムリスナー</h3><p>ドキュメントは<a href="https://firebase.google.com/docs/firestore/query-data/listen?hl=ja">これ</a>。Firestore使うまでは「リアルタイム更新は面倒そうだからポーリングすればいいかなぁ〜」とか考えていたんだけども、そういえばSDKがいい感じにやってくれるやつあったな、なんて思い出したので使ってみた。</p><p>今回はReactで書いたwebアプリケーション上で新しく登録されたデータをどんどんページ上部に表示したいのでこんな感じで実装した。</p><p>componentDidMount() {<br>this.citiesRef = db.collection('cities')<br>this.citiesRef.orderBy('created', 'desc').onSnapshot(snapshot =&gt; {<br>const cities = []<br>snapshot.forEach(doc =&gt; cities.push(doc.data().name))<br>this.setState({ cities: cities.concat(this.state.cities) })<br>})<br>}</p><p>たったこれだけのコードでListenしてくれるってことにも感動だし、普通に考えたら面倒な実装をデフォでやってくれているのが嬉しい。これだけのためにFirestore使ってるまであるな…とか思った。</p><h3>忘年会がいっぱい</h3><p>気づけば今日から1週間、なんかしら飲む予定が入ってて年末感を感じた。そろそろ30代も見えてきたので無理せずにちゃんと家まで意識を持って帰れるようにしていきたい。たまに20代前半だった自分を思い出すとなぜこんなに身体がいうことを聞かなく…とか思っちゃう時があるのでなるべく運動したりして抗っていこう。</p></article></main><footer><p>&copy; 2019 dachi</p></footer></body></html>